Advanced Resource Connector (ARC)
=================================


Release Notes for NorduGrid ARC  6.0.0     27.05.2019
-------------------------------------------------------------------------

We are very happy to announce the first release of the ARC 6 release series.

ARC 6 contains major improvements in the deployment, configuration and maintenance of ARC CE.
It also comes with new features and services while some legacy features have been removed.

Although there has been some major re-engineering in the code base (see below),
the interfaces are unchanged - ARC 5 clients (as of 5.X.Y) are compatible with an ARC 6 CE and vice versa.

With ARC 6 we hope to have greatly increased the ease of setting up and maintaining an ARC production site. 


Important Changes
-----------------

* Complete overhaul of configuration
* Validation of the ARC configuration is enforced by A-REX startup scripts.
  If you have configuration errors then A-REX will not start. 
* Runtime environments (RTEs) must be explicitly enabled through the new arcctl tool (see below)
* Renaming of startup scripts and default log files

* The NorduGrid schema is no longer published by default - it must be enabled via the [infosys/nordugrid] block
* Gridmap files (although still supported) are no longer recommended.
  VO-based authorisation should be configured as described in the installation guide:
  http://www.nordugrid.org/arc/arc6/admins/arc6_install_guide.html#configure-authorization-rules. 

* Nordugrid ARC no longer issues a bundle including documentation, gangliarc and nagios
  ** The documentation is no longer distributed as a separate package with the release.
     You can find the current and up-to-date (but not fully complete) doumentation online:
     http://www.nordugrid.org/documents/arc6/index.html
  ** The separate gangliarc component is discontinued, instead we now have ganglia integrated into AREX.
     For configuration options, see: http://www.nordugrid.org/documents/arc6/admins/reference.html
  ** Nagios probes have their own release cycle and are no more included in the Nordugrid ARC release.
     The source-code together with the installation instructions can be found here:
     https://source.coderefinery.org/nordugrid/arc-nagios-plugins
     The Nagios packages are still hosted by the Nordugrid repository.


*  ARC6 client now returns walltime as (walltime)*(number of cores)
** Known issue: Due to granularity of information in GLUE2 and NorduGRID schema,
   the GLUE2 schema is more accurate and the returned values might differ by +/- 1 min between the two schemas


Bugs fixed since ARC 5
-----------------------
A full list of bugs fixed since ARC 5 can be found here: http://www.nordugrid.org/documents/arc6/common/changelog/bugs-6.0.0.html and at the end of these release notes. 


Improvements and new features
-----------------------------

* Major server-side configuration changes
** Configuration has been cleaned up, regrouped and made more streamlined.
** ARC now comes with a so-called zero configuration - a preconfigured minimal ARC setup automatically installed with ARC,
   including test-CA and test host certificate for immediate test submission.
** ARC now operates with a so-called running configuration which is based on arc.conf
   (which is to be manually edited by the system administrator) but in addition includes any unchanged default values
   present in ARC. You can get a dump of the running configuration using the arcctl tool.
** Default values have had a big tidy up and are now handled consistently throughout ARC.

* A new server-side control tool: arcctl has been developed.
** With this tool you can handle the configuration, the RTEs, the jobs, and many other things related to running an ARC CE.

* The RTE framework
**  The RTE framework has got a redesigned architecture and largely extended functionality
    (default, installed, enabled RTEs, introduction of RTE parameters).
** There are several system RTE's installed together with ARC which you can enable on demand. These are
*** ENV/CANDYPOND:  makes ARC Candypond client availble on the Worker Nodes and ready to be used
*** ENV/CONDOR/DOCKER: enables submission to Docker universe in HTCondor backend
*** ENV/LRMS-SCRATCH: enables the usage of local to WN scratch directory defined by LRMS
*** ENV/PROXY: copy proxy certificate to the job session directory
*** ENV/RTE: copy RunTimeEnvironment scripts to the job session directory

* ARCHERY has been introduced as the new DNS-based service indexing catalogue retiring the ldap-based EGIIS

* Accounting configuration, archive and operations has been restructured to improve typical operations
  like setting up republishing and gathering stats locally. There is better integration with APEL SSM.

* Mapping is now coupled to authgroup and has different configurable policies for rules processing.
  For more information see: http://www.nordugrid.org/arc/arc6/admins/reference.html#mapping-block


* The internal job-loop in A-Rex has been re-engineered to be event-driven in order to improve scalability.
* xrootd plugin has been re-written to improve data transfer performance
* Candypond - Cache and deliver your pilot on-demand data" is introduced as technology preview
  - see http://www.nordugrid.org/arc/arc6/tech/data/candypond.html
* Experimantal Python LRMS released first time for SLURM with SSH access support


* Packaging has been restructured:
** Streamlined package name scheme
** ldap services have been separated out, as for instance WS and INTERNAL submission do not need ldap.
** The INTERNAL submission plugin is separately packaged.


* Two new submission interfaces have been included, both are *technology previews and not for production*
 ** The REST interface - enabled together with the A-Rex Web-Service.
 ** The INTERNAL interface - a special interface aimed for restrictive HPC sites,
    to be used with a local installation of the ARC Control Tower.



Documentation
---------------------
The ARC 6 documentation has been rewritten in a modern format and is palced at a new location:  http://www.nordugrid.org/documents/arc6

Please note that although the most important parts of the ARC 6 documentation are in place, it is still not fully complete.
If you have questions, please contact us!


Installing ARC 6 
--------------------------------------------------
We recommend to install ARC release using the Nordugrid repository.
* Start with the basics: http://www.nordugrid.org/documents/arc6/admins/try_arc6.html
* Get production ready: http://www.nordugrid.org/documents/arc6/admins/arc6_install_guide.html#arc6-install-guide 


NOTE
---------
If you are updated from ARC5 with old jura accounting archive already containing records,
the conversion process to index the archive structure will be initiated and will cause serious system load until finished.
To avoid old archive conversion, you can move records before update.

We build for the following systems:
  * Debian: 7.0 - 9.0 (i386 and amd64)
  * Fedora: 12 - 30 (i386 and x86_64)
  * CentOS: EL6 (i386 and x86_64) and EL7 (x86_64)
  * Ubuntu: 14.04 - 18.10 (i386 and amd64, both LTS and interim releases)



Future support of ARC 5-series
-------------------------------
* Note that once ARC 6.0.0 is released, we will only provide security updates of ARC 5.*


Getting in touch
-----------------
If you need help with the configuration file or have any other questions related to ARC 6, please contact us via
* Email: nordugrid-discuss@nordugrid.org
* Skype channel dedicated to ARC 6 support: https://join.skype.com/dyf3A6Uutjy2



List of bugs fixed since ARC 5
------------------------------
* 895	ARC Administrative tools
* 1421	No log of backend script problems
* 3034	arcstat -s is case-sensitive
* 3106	arcproxy could be more expressive when it finds a problem
* 3360	SGE and LL backends fail to report correct node OS/system information in GLUE2 infosystem
* 3384	Support for per-queue authorisation configuration and publishing
* 3451	Configure number of cpus manually
* 3476	Crashes in multiple ARC components
* 3545	Patch for Correct Cores Parsing
* 3557	undetected job submission in case of heavy filesystem load
* 3565	Allow setting default VO in ~/.arc/client.conf to be used in arcproxy
* 3566	Implement RTEs processing without shared directory
* 3569	Exporting CPU/Wall time limits to Glue2/BDII
* 3570	Arcsub used 100GB memory
* 3584	JURA: create one log file per job, not per submission
* 3624	Data delivery service can only listen to one network interface.
* 3626	Force GLUE2ComputingManagerTotalLogicalCPUs to be totalcpus when this value is defined in arc.conf
* 3632	arcproxy fails in Ubunt 16.04, 16.10 and recent Debian systems
* 3637	arcget with multiple jobs crashes
* 3643	The watchdog crashes
* 3662	arcsub crashes
* 3667	JSON output for arcstat
* 3674	settings in client.conf ignored
* 3675	Problems retrieving jobs with arcget 1
* 3676	Problems retrieving jobs with arcget 2 (first byte missing)
* 3677	arcproxy fails retrieving attributes from voms
* 3682	Better error message when DN not in gridmap file
* 3690	Warnings about missing information on deleted jobs
* 3695	Slowness with arccp and the xrootd protocol
* 3700	ARC1ClusterInfo.pm uses netstat
* 3702	Cannot use arc data commands without certificates
* 3707	Seg fault Triolith - related or not to the data-staging problems on Triolith
* 3713	Malformed jobs.dat entries
* 3722	Xenial repo for the (nordugrid) ARC source is not correct
* 3756	package update failed to restart A-REX
* 3772	Can't use different credentials within one submission process when jobs require user input files
* 3773	Enabling arex-ganglia breaks controldir access
* 3778	arcctl not working if arc code configured with --disable-swig flag and installed with make install
* 3788	Poor performance with arccp and HTTPS
* 3812	A-REX hangs inside XRootd after fork

%% LyX 1.4.5.1 created this file.  For more info, see http://www.lyx.org/.
%% Do not edit unless you really know what you are doing.
\documentclass[english]{book}
\usepackage[T1]{fontenc}
\usepackage[latin1]{inputenc}
\setcounter{secnumdepth}{3}
\setcounter{tocdepth}{3}
\usepackage{calc}
\usepackage{graphicx}

\makeatletter

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% LyX specific LaTeX commands.
%% Because html converters don't know tabularnewline
\providecommand{\tabularnewline}{\\}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% User specified LaTeX commands.

%\documentclass{article}                            %for shorter notes
                              %for PNG images (pdflatex)
%\usepackage{graphics}                              %for EPS images (latex)
\usepackage[linkbordercolor={1.0 1.0 0.0}]{hyperref}
 %for \url tag
\usepackage{color}
                                 %for defining custom colors
\usepackage{framed}
                                %for shaded and framed paragraphs
\usepackage{textcomp}
                              %for various symbols, e.g. Registered Mark
\usepackage{geometry}
                              %for defining page size
\usepackage{longtable}
                             %for breaking tables
%
\geometry{verbose,a4paper,tmargin=2.5cm,bmargin=2.5cm,lmargin=2.5cm,rmargin=2cm}
\hypersetup{
  pdfauthor = {Author Name},
  pdftitle = {Paper title},
  pdfsubject = {Paper subject},
  pdfkeywords = {Paper,keyword,comma-separated},
  pdfcreator = {PDFLaTeX with hyperref package},
  pdfproducer = {PDFLaTeX}
}
%
\bibliographystyle{IEEEtran}                       %a nice bibliography style
%
\def\efill{\hfill\nopagebreak}%
\hyphenation{Nordu-Grid}
\setlength{\parindent}{0cm}
\setlength{\FrameRule}{1pt}
\setlength{\FrameSep}{8pt}
\addtolength{\parskip}{5pt}
\renewcommand{\thefootnote}{\fnsymbol{footnote}}
\renewcommand{\arraystretch}{1.3}
\newcommand{\dothis}{\colorbox{shadecolor}}
\newcommand{\globus}{Globus Toolkit\textsuperscript{\textregistered}~2~}
\newcommand{\GT}{Globus Toolkit\textsuperscript{\textregistered}}
\newcommand{\ngdl}{\url{http://ftp.nordugrid.org/download}~}
\definecolor{shadecolor}{rgb}{1,1,0.6}
\definecolor{salmon}{rgb}{1,0.9,1}
\definecolor{bordeaux}{rgb}{0.75,0.,0.}
\definecolor{cyan}{rgb}{0,1,1}
%
%----- DON'T CHANGE HEADER MATTER


\usepackage{babel}
\makeatother
\begin{document}
\def\today{\number\day/\number\month/\number\year}

\begin{titlepage}

\begin{tabular}{rl}
\resizebox*{3cm}{!}{\includegraphics{tex/ng-logo}} &
%
\parbox[b][0pt]{2cm}{%
\textit{{\hspace*{-1.5cm}NORDUGRID\vspace*{0.5cm}
}}%
}%
 \tabularnewline
\end{tabular}

\hrulefill

%-------- Change this to NORDUGRID-XXXXXXX-NN


{\raggedleft NORDUGRID-TECH-16

}

{\raggedleft \today

}

\vspace*{2cm}


%%%%---- The title ----
{\centering \textsc{\Large Security Infrastructure of ARC1}{\Large \par}

} \vspace*{0.5cm}


%%%%---- A subtitle, if necessary ----
{\centering \textit{\large Paper subtitle}{\large \par}

}

\vspace*{1.5cm}
 {\centering {\large Weizhong Qiang}%
\footnote{weizhongqiang@gmail.com%
}{\large , Aleksandr Konstantinov}%
\footnote{aleks@fys.uio.no%
} {\large }{\large \par}

}

%%%%---- An abstract - if style is article ----
%\begin{abstract}
%The abstract
%\end{abstract}
\end{titlepage}

\tableofcontents{}%Comment if use article style
\newpage{} 


\chapter{Introduction\label{sec:introduction}}

This document describes Security Infractructure of ARC1 middleware.


\chapter{Security architecture in HED: SecHandlers and PDP\label{sec:architecture}}


\chapter{Policy Evaluation engine\label{sec:policy_engine}}


\section{ArcPDP Policy Evaluator\label{sec:policy_evaluator}}


\chapter{Secuirty Attributes\label{sec:sec_attr}}


\section{Infrastructure\label{sec:sec_attr_infrastructure}}

Security Attributes represent security related information inside
HED framework and store information representing various aspects needed
to perform authorization decison - identity of client, requested action,
targeted resource, constraint policies. 

Each kind of Security Attribute is represented by own class inherited
from parent SecAttr class <arc/message/SecAttr.h>. Each Security Attribute
stores it's information in internal format and is capable to export
it to one of predefined formats using Export() method. Currently only
supported format is Arc Policy/Request XML document.

Collectors of Security Attributes instantiate corresponding classes
and link them to Secuirity Attributes containers - MessageAuth <arc/message/MessageAuth.h>
and MessageAuthContext <arc/message/Message.h> storing collected attributes
per request and per session correspondingly. Current implementations
of Security Attributes Collectors are either integrated into existing
MCCs or implemented as separate SecHandler plugins. See Section \ref{sec:sec_attr_collectors}
for available Collectors and corresponding Security Attributes. 

\begin{framed}Note for service developers: Services may implement
own authorization algorithms. But they may use Security Atributes
as well by providing instances of classes inherited from SecAttr and
running them through either configured or hardcoded processors/PDPs.\end{framed}

Processors of Security Attributes are implemented as Policy Decision
Point components. Currently there are 2 PDP components available:

\begin{itemize}
\item ArcPDP makes use of Security Attributes containing identities of client,
resource and requested action. It evaluates either all or selected
set of attributes against specified Policy documents thus making it
possible to enforce policies defined/selected by service providers. 
\item (to move to Delegation section) DelegationPDP is similar to ArcPDP
except that it takes it's Policy documents directly from Security
Attributes. Differently from Arc PDP it is meant to be used for enforcing
policies defined by client.
\end{itemize}

\section{Available collectors\label{sec:sec_attr_collectors}}


\subsection{TCP}

Information is collected inside TCP MCC. Security Attribute exports 

ARC Request with following attributes

Element AttributeId Content

Resource http://www.nordugrid.org/schemas/policy-arc/types/localendpoint
service\_ip{[}:service\_port] 

SubjectAttribute http://www.nordugrid.org/schemas/policy-arc/types/remoteendpoint
client\_ip{[}:client\_port] 


\subsection{TLS}

Information is collected inside TLS MCC. Generated Security Attribute
class exports ARC Request with following attributes:

\begin{tabular}{|c|c|c|}
\hline 
\multicolumn{1}{|c|}{Element}&
AttributeId&
Content\tabularnewline
\hline
\hline 
SubjectAttribute&
http://www.nordugrid.org/schemas/policy-arc/types/tls/ca&
Subject of signer of first certificate in client's chain\tabularnewline
\hline 
SubjectAttribute&
http://www.nordugrid.org/schemas/policy-arc/types/tls/chain&
Subject of certificate in client's chain - multiple items\tabularnewline
\hline 
SubjectAttribute&
http://www.nordugrid.org/schemas/policy-arc/types/tls/subject&
Subject of last certificate in client's chain\tabularnewline
\hline 
SubjectAttribute&
http://www.nordugrid.org/schemas/policy-arc/types/tls/identity&
Subject of last non-proxy certificate in client's chain\tabularnewline
\hline
\end{tabular}


\subsection{HTTP}

Information is collected inside TLS MCC. Security Attribute exports
ARC Request with following attributes:

\begin{tabular}{|c|c|c|}
\hline 
Element&
AttributeId&
Content\tabularnewline
\hline
\hline 
Resource&
http://www.nordugrid.org/schemas/policy-arc/types/http/path&
HTTP path without host and port part\tabularnewline
\hline 
Action&
http://www.nordugrid.org/schemas/policy-arc/types/http/method&
HTTP method\tabularnewline
\hline
\end{tabular}


\subsection{SOAP}

Information is collected inside TLS MCC. Security Attribute exports
ARC Request with following attributes

\begin{tabular}{|c|c|c|}
\hline 
Element&
AttributeId&
Content\tabularnewline
\hline
\hline 
Resource&
http://www.nordugrid.org/schemas/policy-arc/types/soap/endpoint&
To element of WS-Addressing structure\tabularnewline
\hline 
Action&
http://www.nordugrid.org/schemas/policy-arc/types/soap/operation&
SOAP top level element name without namespace prefix\tabularnewline
\hline 
Context&
http://www.nordugrid.org/schemas/policy-arc/types/soap/namespace&
Namespace of SOAP top level element\tabularnewline
\hline
\end{tabular}


\subsection{Delegation}

(to move to Delegation section) This Security Attribute is collected
by dedicated Security Handler plugin named {}``\emph{delegation.pdp}''
avaialble in \emph{arcpdc} plugins' library. It extracts policy document
stored inside X509 certificate proxy extension as defined in RFC3820.
All proxy certificates in a chain provided by client are examined
and all available policies are extracted. 

Policies are stored in string content of \emph{ProxyPolicy} element
with \emph{id-ppl-anyLanguage}. Extracted content is converted into
XML document. Then document is checked to be of Arc Policy kind. If
policy is not recognized as Arc Policy procedure fails and that causes
failure of comunication.

Proxy certificates with \emph{id-ppl-inheritAll} property are passed
through and no policy document is generated for them. Proxies with
other type of policies including \emph{id-ppl-independent} are not
accepted and generate immediate failure.


\chapter{Delegation restrictions\label{sec:delegation}}


\section{Delegation architecture\label{sec:delegation_architectire}}


\section{Delegation PDP\label{sec:delegation_pdp}}


\chapter*{Schemas and comments\label{sec:schemas}}


\section*{Policy}


\section*{Request}


\section*{ArcPDP configuration}


\section*{DelegationPDP configuration}


\chapter*{Examples:}


\section*{Policy}


\section*{Request}


\section*{Delegation Policy}


\chapter*{Template examples}

In expressions, the following operands are allowed: \begin{shaded}
\verb#=   !=   >   <   >=   <=# \end{shaded}

\begin{framed} Examples of URLs are:\\
 \\
 \verb#http://grid.domain.org/dir/script.sh#\\
 \verb#gsiftp://grid.domain.org:2811;threads=10/dir/input_12378.dat#\\
 \verb#ldap://grid.domain.org:389/lc=collection1,rc=Nordugrid,dc=nordugrid,dc=org#\\
 \verb#rc://grid.domain.org/lc=collection1,rc=Nordugrid,dc=nordugrid,dc=org/zebra/f1.zebra#
\verb#file:///home/auser/griddir/steer.cra#\\
 \end{framed}

%\subsection{Subsection}
%\label{sec:subsection}


%
\begin{figure}[ht]
 \centering{{\scalebox{0.9}{\includegraphics{tex/ng-logo}}} 


\caption{\label{fig:myfigure1}The figure shows a logo.}

} 
\end{figure}


\bibliography{grid}
 
\end{document}

_storage()
{
    cur=${COMP_WORDS[COMP_CWORD]}
    prev=${COMP_WORDS[COMP_CWORD-1]}
    options=
    if [[ "$COMP_CWORD" == 1 ]];
    then
        options='hash catalog manager element';
    else
        case $prev in
            hash)
                options='get change changeIf'
                ;;
            catalog)
                options='get traverseLN new modifyMetadata remove'
                ;;
            manager)
                options='stat makeCollection list move putFile getFile'
                ;;
            element)
                options='get put stat'
                ;;
        esac
    fi
    if [[ "-$options" == "-" ]];
    then
        case $prev in
            putFile)
                COMPREPLY=( $( compgen -o default -- $cur) ) 
                ;;
            getFile)
                COMPREPLY=( $( compgen -o default -- $cur) ) 
                ;;
        esac
    else
        COMPREPLY=( $( compgen -W "$options" -- $cur) )
    fi
}
complete -F _storage storage

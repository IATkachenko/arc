	GATEWAY COMPONENT OF ARC-1

GatewayService: 
High level service, deals with the low level service.

ExternalStorageInformationSerivce: 
Low level service, used to provide information regarding external storage systems.

TransferService: 
Low level Service, initiates the data tranfer.

Description:
Gateway services are heavily dependent on DMC(Data Management Component of ARC1). Currently TransferService uses the DMC client commandline tool arcls only. Final version will access DMC using python bindings. 

Important Note: 
Current version only supports LISTING of the file/directory from the DCACHE store using gridftp protocol. 

Available External Stores:
For the test porpose we are using small DCACHE setup available in Uppsala University, running on the machine

	sal1.uppmax.uu.se 	(DCACHE ADMIN NODE)
	sal3.uppmax.uu.se  	(POOL NODE)

Both of them running the gridftpdoor.

Requirments:
ARC1 should be installed including DMC. Check whether you can run the following commands,

	# arcls <gridftp-url>
	# arccp <gridftp-url-1> <gridftp-url-2>
	
How it works:
1- Gateway client send the request to the gateway service with the following parameters

	request - contains the path of the file/directory in the external system. for example,
			
		/mycollection/dCache/pnfs/uppmax.uu.se/data/file-1
	
	This path have two parts 
		
	i  - /mycollection/dCache, shows that the request should forward to the available DCACHE system. Curr		  ently the dCache is an ordinary sub-collection but in the later version it will be created as a sp	       ecial collection in the storage system.	  
	
	ii - /pnfs/uppmax.uu.se/data/file-1, this path is used to access the file in the DCACHE system.

	options - optinal argument, contains other parameters like whether long listing is required or not.

2- Gateway service sends request to the ExternalStorageInformation service to get the list of the registered external stores. Currently a text file contains this information. 

3- Once Gateway service gets the information of the external store, it sends the information of the avialable external stores together with the second part of the URL to the transfer service. 

4- Transfer service connects to the external store get the relavent information and send it back to the Gateway service.     
 
Usage:
1- use run.sh to start the services. Both 'run.sh' and 'service.xml' for the gatway services are available in the following path 'arc1/src/services/storage/gateway/Client'.

2- open any python editor e-g 'ipython'

	2a- from storage.client import GatewayClient

	2b- gatewayObj = GatewayClient('http://localhost:60000/Gateway') 

	2c- gatewayObj.list('/dCache/pnfs/uppmax.uu.se/data')

			or

	2c- gatewayObj.list('/mycollection/dCache/pnfs/uppmax.uu.se/data')

			or

	2c- For the long-listing: 

	    gatewayObj.list('/dCache/pnfs/uppmax.uu.se/data', '-l')  
	
	Note:
	I am assuming "dCache" as a sub-collection to identify the external store.
 
3- It will return a python-dictionary having status and the output of the request.   	    
	{'': ['0','torque-2.2.1.tar.gz_3\ntorque-2.2.1.tar.gz\ntorque-2.2.1.tar.gz_1\ntorque-2.2.1.tar.gz_2']}


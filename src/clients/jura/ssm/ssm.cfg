################################################################################
# Required: broker configuration options
#
# NB the same broker is used for sending and receiving messages

[broker]
#host: dev.msg.cern.ch
#port: 6163

################################################################################
# Required: Local message storage
#
# Messages stored in <path>/outgoing will be encrypted and sent. Incoming
# messages will be saved in <path>/incoming

[messagedb]

# Root of the message storage. This location will be created by the messaging
# system, but it needs write access to the parent directory to do so
path: $SSM_HOME/messages
# Whether incoming messages are deleted (production) or saved (testing)
test: true

################################################################################
# Required: Certificate configuration

[certificates]
#certificate: /etc/grid-security/hostcert.pem
#key: /etc/grid-security/hostkey.pem
#cadir: /etc/grid-security/certificates
check-crls: true

################################################################################
# Required: Logging configuration

[logging]
#log-conf-file: $SSM_HOME/conf/ssm.log.cfg
log-conf-file: $CONF_HOME/ssm.log.cfg

################################################################################
# Optional: Consumer configuration.
# Only configure this section if you want the SSM to receive messages.

#[consumer]

# Topic that we'll listen to for messages
#topic: /topic/grid.accounting.cpuTest.CENTRAL

# file containing a list of DNs that we will accept messages from (the message
# signature is used to determine the DN of the producer)
#validDN: /etc/ssm-valid-dns.conf
#valid-dns: $SSM_HOME/conf/ssm-valid-dns.conf

# How often (in seconds) the SSM will check the valid DNs file
#read-valid-dns: 1800

# End of Section
################################################################################


################################################################################
# Required: Producer configuration.
# Even if you don't need to send messages, you need to leave this section
# enabled; it is used to send pings to maintain the connection.

[producer]

# Topic that we are to send messages to
#topic: /topic/grid.accounting.cpuTest.CENTRAL

# The DN of the consumer of our messages - the SSM can only send to one
# consumer and it uses that system's certificate for encryption
consumer-dn: /C=UK/O=eScience/OU=CLRC/L=RAL/CN=raptest.esc.rl.ac.uk/emailAddress=sct-certificates@stfc.ac.uk

# How often (in seconds) we clear the certificate of the consumer SSM.  This 
# is so that if the consumer changes its certificate, a running SSM won't 
# get too confused.
clear-consumer-cert: 86400

# The consumer will send an ack back to us using this message channel on the
# broker. You can use the following variables:
#  $host - the hostname
#  $pid  - Process ID of the producer
ack: /topic/grid.accounting.cpuTest.NGI.$host.$pid

# End of Section
################################################################################

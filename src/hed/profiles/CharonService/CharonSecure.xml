<?xml version="1.0"?>
<cfg:ArcConfig xmlns="http://www.nordugrid.org/schemas/loader/2009/08" xmlns:cfg="http://www.nordugrid.org/schemas/arcconfig/2009/08" xmlns:tcp="http://www.nordugrid.org/schemas/tcp/2009/08" xmlns:tls="http://www.nordugrid.org/schemas/tls/2009/08" xmlns:charon="http://www.nordugrid.org/schemas/charon/2009/08">
    <cfg:Server>
        <cfg:PidFile inisections="common" initag="pidfile">/tmp/arched.pid</cfg:PidFile>
        <cfg:Logger>
            <cfg:File inisections="common" initag="logfile">/var/log/arched.log</cfg:File>
            <cfg:Level inisections="common" initag="debug">ERROR</cfg:Level>
        </cfg:Logger>
    </cfg:Server>
	<ModuleManager>
        <Path inisections="common" initag="libpath">/usr/local/lib/arc/</Path>
	</ModuleManager>
	<Plugins><Name>mcctcp</Name></Plugins>
	<Plugins><Name>mcctls</Name></Plugins>
	<Plugins><Name>mcchttp</Name></Plugins>
	<Plugins><Name>mccsoap</Name></Plugins>
	<Plugins><Name>arcshc</Name></Plugins>
	<Plugins><Name>charon</Name></Plugins>
	<Chain>
		<Component name="tcp.service" id="tcp">
			<next id="tls"/>
            <tcp:Listen>
                <tcp:Interface inisections="common" initag="interface">0.0.0.0</tcp:Interface>
                <tcp:Port inisections="common" initag="port"/>
                <tcp:Version inisections="common" initag="ipversion">4</tcp:Version>
            </tcp:Listen>
		</Component>
	<Component name="tls.service" id="tls">
		<next id="http"/>
            <tls:KeyPath inisections="common" initag="host_key"/>
            <tls:CertificatePath inisections="common" initag="host_cert"/>
            <tls:CACertificatesDir inisections="common" initag="ca_dir"/>
	</Component>
		<Component name="http.service" id="http">
            <next id="soap">POST</next>
            <next id="plexer">GET</next>
            <next id="plexer">PUT</next>
		</Component>
		<Component name="soap.service" id="soap">
			<next id="plexer"/>
		</Component>
		<Plexer name="plexer.service" id="plexer">
            <next id="charon_service" inisections="charon" initag="urlpattern">^/Charon$</next>
		</Plexer>
		<Service name="charon" id="charon_service">
	    	<charon:PolicyStore>
		    	<charon:Location Type="file" inisections="charon" initag="policy_file">Arc_Policy_Example.xml</charon:Location>
			</charon:PolicyStore>
			<charon:Evaluator name="arc.evaluator" />
			<charon:Policy name="arc.policy" />
			<charon:Request name="arc.request" />
		</Service>
	</Chain>
</cfg:ArcConfig>
